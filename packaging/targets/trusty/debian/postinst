#!/bin/bash
set -x


OI=/var/lib/openinfoman
USERNAME=oi
BASEX=$OI/bin/basex

SFS=("stored_query_definitions/health_worker_urn_search_by_id.xml" "stored_query_definitions/health_worker_indices_address.xml" "stored_query_definitions/health_worker_indices_provider_facility.xml" "stored_query_definitions/health_worker_read_name.xml" "stored_query_definitions/health_worker_indices_service.xml" "stored_query_definitions/health_worker_read_otherids.xml" "stored_query_definitions/facility_indices_otherid.xml" "stored_query_definitions/health_worker_read_credential.xml" "stored_query_definitions/health_worker_read_org_address.xml" "stored_query_definitions/facility_name_search.xml" "stored_query_definitions/health_worker_read_provider.xml" "stored_query_definitions/facility_read_organization.xml" "stored_query_definitions/facility_read_otherid.xml" "stored_query_definitions/facility_indices_address.xml" "stored_query_definitions/organization_get_urns.xml" "stored_query_definitions/facility_read_contact_point.xml" "stored_query_definitions/organization_read_address.xml" "stored_query_definitions/facility_indices_contact_point.xml" "stored_query_definitions/health_worker_read_service.xml" "stored_query_definitions/health_worker_indices_provider_organization.xml" "stored_query_definitions/facility_read_service.xml" "stored_query_definitions/health_worker_indices_org_contact_point.xml" "stored_query_definitions/bulk_health_worker_read_otherids_json.xml" "stored_query_definitions/organization_indices_otherid.xml" "stored_query_definitions/health_worker_get_urns.xml" "stored_query_definitions/health_worker_read_provider_organization.xml" "stored_query_definitions/health_worker_read_provider_facility.xml" "stored_query_definitions/health_worker_indices_otherid.xml" "stored_query_definitions/health_worker_indices_credential.xml" "stored_query_definitions/health_worker_read_org_contact_point.xml" "stored_query_definitions/organization_indices_address.xml" "stored_query_definitions/facility_indices_organization.xml" "stored_query_definitions/health_worker_indices_contact_point.xml" "stored_query_definitions/health_worker_read_address.xml" "stored_query_definitions/organization_name_search.xml" "stored_query_definitions/health_worker_read_otherids_json.xml" "stored_query_definitions/health_worker_indices_org_address.xml" "stored_query_definitions/health_worker_indices_name.xml" "stored_query_definitions/organization_indices_contact_point.xml" "stored_query_definitions/organization_read_credential.xml" "stored_query_definitions/health_worker_read_otherid.xml" "stored_query_definitions/health_worker_indices_operating_hours.xml" "stored_query_definitions/health_worker_read_operating_hours.xml" "stored_query_definitions/facility_indices_service.xml" "stored_query_definitions/organization_read_otherid.xml" "stored_query_definitions/service_get_urns.xml" "stored_query_definitions/facility_get_urns.xml" "stored_query_definitions/provider_name_search.xml" "stored_query_definitions/organization_indices_credential.xml" "stored_query_definitions/organization_read_contact_point.xml" "stored_query_definitions/facility_read_address.xml" "stored_query_definitions/health_worker_read_contact_point.xml" "stored_updating_query_definitions/health_worker_delete_org_contact_point.xml" "stored_updating_query_definitions/health_worker_update_contact_point.xml" "stored_updating_query_definitions/health_worker_delete_otherid.xml" "stored_updating_query_definitions/health_worker_create_org_address.xml" "stored_updating_query_definitions/health_worker_delete_provider_facility.xml" "stored_updating_query_definitions/health_worker_update_service.xml" "stored_updating_query_definitions/health_worker_update_provider_facility.xml" "stored_updating_query_definitions/health_worker_update_provider_organization.xml" "stored_updating_query_definitions/health_worker_create_service.xml" "stored_updating_query_definitions/health_worker_create_provider_organization.xml" "stored_updating_query_definitions/health_worker_delete_address.xml" "stored_updating_query_definitions/health_worker_update_provider.xml" "stored_updating_query_definitions/health_worker_create_org_contact_point.xml" "stored_updating_query_definitions/health_worker_delete_operating_hours.xml" "stored_updating_query_definitions/health_worker_create_provider.xml" "stored_updating_query_definitions/health_worker_delete_credential.xml" "stored_updating_query_definitions/health_worker_update_operating_hours.xml" "stored_updating_query_definitions/health_worker_update_name.xml" "stored_updating_query_definitions/health_worker_delete_name.xml" "stored_updating_query_definitions/health_worker_create_credential.xml" "stored_updating_query_definitions/health_worker_delete_org_address.xml" "stored_updating_query_definitions/health_worker_create_contact_point.xml" "stored_updating_query_definitions/health_worker_update_otherid.xml" "stored_updating_query_definitions/health_worker_create_provider_facility.xml" "stored_updating_query_definitions/health_worker_create_address.xml" "stored_updating_query_definitions/health_worker_delete_service.xml" "stored_updating_query_definitions/health_worker_update_address.xml" "stored_updating_query_definitions/health_worker_delete_provider_organization.xml" "stored_updating_query_definitions/health_worker_update_org_contact_point.xml" "stored_updating_query_definitions/health_worker_update_credential.xml" "stored_updating_query_definitions/health_worker_create_operating_hours.xml" "stored_updating_query_definitions/health_worker_delete_contact_point.xml" "stored_updating_query_definitions/health_worker_delete_provider.xml" "stored_updating_query_definitions/health_worker_update_org_address.xml" "stored_updating_query_definitions/health_worker_create_name.xml" "stored_updating_query_definitions/health_worker_create_otherid.xml" )


for SF in ${SFS[@]}
do
  cd $OI
  $OI/resources/scripts/install_stored_function.php $OI/resources/$SF 
  if [[ $? != 0 ]]; then exit 1; fi
done

chown -R $USERNAME:$USERNAME $OI